<ui:composition template="template/main.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">

	<ui:define name="content">
		<div id="container" style="border: none; padding-left: 2em;"
			align="left">
			<h1>Dados do Node</h1>

			<h:form>
				<p:growl id="growl" sticky="false" showDetail="true" life="8000" />

				<h:panelGrid columns="3">
					<p:outputLabel value="Node: " />
					<p:inputText placeholder="Digite o código do Node"
						value="#{projetoMB.node.codNode}" required="true" />

					<p:commandButton id="ajax" value="Buscar"
						actionListener="#{projetoMB.loadNode()}" process="@form"
						update="@form" rendered="#{projetoMB.node.codNode ne ''}" />
				</h:panelGrid>

				<br />

				<p:dataTable id="dtRetorno" var="conn"
					value="#{projetoMB.retornoConnectorsList()}" style="width: 60%;">
					<p:column style="width:15%">

						<f:facet name="header">
							<h:outputText value="CMTS" />
						</f:facet>
						#{conn.placa.slot.cmts.nome}
					</p:column>

					<p:column style="width:12%">
						<f:facet name="header">
							<h:outputText value="Placa" />
						</f:facet>
							#{conn.placa.slot.codSlot} - #{conn.placa.codPlaca}
						</p:column>

					<p:column style="width:9%">
						<f:facet name="header">
							<h:outputText value="Conector" />
						</f:facet>
							#{conn.numConector}
						</p:column>
					<p:column>
						<f:facet name="header">
							<h:outputText value="Upstreams" />
						</f:facet>
						<ui:repeat var="up" value="#{conn.upstreamList}">
							<ui:repeat varStatus="status" var="node" value="#{up.nodes}">
								<p:outputLabel rendered="false"
									value=" (- #{node.codNode.contains(projetoMB.node.codNode)} - #{up.numUpStream} - #{node.codNode} -) " />
								<p:outputLabel
									value=" #{projetoMB.setUpstreamRendered(up, node)}" />
								<h:outputText
									rendered="#{(node.codNode.contains(projetoMB.node.codNode)) and (conn.upstreamList.indexOf(up) ne conn.upstreamList.size()-1)}"
									value=", " />
							</ui:repeat>

						</ui:repeat>
					</p:column>

					<p:column>
						<f:facet name="header">
							<h:outputText value="Retorno" />
						</f:facet>

						<ui:repeat var="up" value="#{conn.upstreamList}">
							<ui:repeat var="node" value="#{up.nodes}">
								<h:outputText value="#{node.codNode}, "
									rendered="#{node.codNode.contains(projetoMB.node.codNode)}" />
							</ui:repeat>
						</ui:repeat>
					</p:column>

					<p:column style="width:12%">
						<f:facet name="header">
							<h:outputText value="Opções" />
						</f:facet>
						<p:commandButton value="Quebrar" process="@this"
							actionListener="#{projetoMB.viewDialogQuebra()}">
							<f:setPropertyActionListener value="#{up}"
								target="#{projetoMB.up}" />
						</p:commandButton>
					</p:column>
				</p:dataTable>

				<br />

				<p:panelGrid id="Direto">
					<p:row>
						<p:column styleClass="ui-style-default">
							<h:outputText value="CMTS" />
						</p:column>
						<p:column styleClass="ui-style-default">
							<h:outputText value="Placa" />
						</p:column>
						<p:column styleClass="ui-style-default">
							<h:outputText value="Conector" />
						</p:column>
						<p:column styleClass="ui-style-default">
							<h:outputText value="Downstream" />
						</p:column>
						<p:column styleClass="ui-style-default">
							<h:outputText value="Direto" />
						</p:column>
					</p:row>

					<c:forEach items="#{projetoMB.diretoConnectorsList()}" var="conn">
						<p:row>
							<p:column>
								<f:facet name="header">
									<h:outputText value="CMTS" />
								</f:facet>
						#{conn.placa.slot.cmts.nome}
					</p:column>
							<p:column>
								<f:facet name="header">
									<h:outputText value="Placa" />
								</f:facet>
							#{conn.placa.slot.codSlot} - #{conn.placa.codPlaca}
						</p:column>

							<p:column>
								<f:facet name="header">
									<h:outputText value="Conector" />
								</f:facet>
							#{conn.numConector}
						</p:column>

							<p:column>
								<f:facet name="header">
									<h:outputText value="Downstream" />
								</f:facet>
								<ui:repeat var="down" value="#{conn.downstreamList}">
									<h:outputText value="#{down.numDownStream}, " />
								</ui:repeat>
							</p:column>

							<p:column>
								<f:facet name="header">
									<h:outputText value="Direto" />
								</f:facet>
								<ui:repeat var="down" value="#{conn.downstreamList}">
									<ui:repeat var="node" value="#{down.nodes}">
										<h:outputText value="#{node.codNode}, "
											rendered="#{node.codNode.contains(projetoMB.node.codNode)}" />
									</ui:repeat>
								</ui:repeat>
							</p:column>
						</p:row>
					</c:forEach>
				</p:panelGrid>
			</h:form>
		</div>
	</ui:define>
</ui:composition>
