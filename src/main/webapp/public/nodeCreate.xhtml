<ui:composition template="template/main.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">

	<ui:define name="content">
		<h:form prependId="false">
			<p:growl id="growl" sticky="false" showDetail="true" life="2000" />

			<p:panel styleClass="form-group" header="Cadastrar Node" style="margin: 15px; width: 900px">
				<h:panelGrid columns="2">
					<p:outputLabel styleClass="control-label" value="Node:" />
					<p:inputText styleClass="form-control" placeholder="Digite o cÃ³digo do Node"
						value="#{nodeMB.node.codNode}" required="true" />

					<p:outputLabel styleClass="control-label" for="hub" value="HUB: " />
					<p:selectOneMenu style="width:150px;" id="hub" value="#{nodeMB.hubId}" required="true">
						<f:selectItem itemLabel="Selecione a HUB" itemValue="" />
						<f:selectItems value="#{nodeMB.hubs}" var="hub"
							itemValue="#{hub.id}" itemLabel="#{hub.codHub}">

						</f:selectItems>
						<p:ajax update="lstBoxCmts"
							listener="#{nodeMB.handleHubListBoxChange}" />
					</p:selectOneMenu>

					<p:outputLabel value="CMTS: " />
					<p:selectOneMenu id="lstBoxCmts" value="#{nodeMB.cmtsId}"
						required="true">
						<f:selectItem itemLabel="Selecione o CMTS" itemValue="" />
						<f:selectItems value="#{nodeMB.cmtsList}" var="cmts"
							itemValue="#{cmts.id}" itemLabel="#{cmts.nome}">

						</f:selectItems>
						<p:ajax update="lstBoxPlaca"
							listener="#{nodeMB.handleCmtsListBoxChange}" process="@this" />
					</p:selectOneMenu>

					<p:outputLabel value="Placa:" />
					<p:selectOneMenu id="lstBoxPlaca" value="#{nodeMB.placaId}"
						required="true">
						<f:selectItem itemLabel="Selecione a Placa" itemValue="" />
						<f:selectItems value="#{nodeMB.placas}" var="placa"
							itemValue="#{placa.id}" itemLabel="#{placa.slot.codSlot} - #{placa.codPlaca}" />
						<p:ajax update="conectors" listener="#{nodeMB.loadPlaca}"
							process="@this" />
					</p:selectOneMenu>
				</h:panelGrid>

				<br />

				<h:panelGroup id="conectors">
					<p:outputLabel value="retorno: " />
					<p:selectOneMenu id="retorno" value="#{nodeMB.selectedRetorno}">
						<f:selectItem itemLabel="A" itemValue="A" />
						<f:selectItem itemLabel="B" itemValue="B" />
						<f:selectItem itemLabel="C" itemValue="C" />
						<f:selectItem itemLabel="D" itemValue="D" />
					</p:selectOneMenu>

					<p:panelGrid id="panelUp" columns="8" style="width:800px;">
						<ui:repeat var="conn" value="#{nodeMB.placa.conectorList}">


							<p:outputLabel rendered="#{not empty conn.upstreamList}"
								value="Conector: #{conn.numConector}" />

							<p:selectManyCheckbox rendered="#{not empty conn.upstreamList}"
								value="#{nodeMB.selectedUps}" layout="grid" columns="4">
								<f:selectItems value="#{conn.upstreamList}" var="up"
									itemValue="#{up.id}" itemLabel="up#{up.numUpStream}" />
							</p:selectManyCheckbox>

						</ui:repeat>

						<p:commandButton id="ajaxUp" value="Add"
							actionListener="#{nodeMB.addUps}" process="@form"
							update="dtRetorno" />
					</p:panelGrid>

					<br />

					<p:dataTable id="dtRetorno" var="up"
						value="#{nodeMB.retornoList()}" style="width: 600px;">
						<p:column>
							<f:facet name="header">
								<h:outputText value="CMTS" />
							</f:facet>
						#{up.conectorUp.placa.slot.cmts.nome}
					</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Placa" />
							</f:facet>
							#{up.conectorUp.placa.codPlaca}
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Conector" />
							</f:facet>
							#{up.conectorUp.numConector}
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Upstream" />
							</f:facet>
							#{up.numUpStream}
						</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Retorno" />
							</f:facet>
							<ui:repeat var="node" value="#{up.nodes}">
								#{node.codNode}, 
							</ui:repeat>
						</p:column>

					</p:dataTable>

					<br />

					<p:outputLabel value="direto: " />
					<p:selectOneMenu id="direto" value="#{nodeMB.selectedDireto}">
						<f:selectItem itemLabel="A" itemValue="A" />
						<f:selectItem itemLabel="B" itemValue="B" />
						<f:selectItem itemLabel="C" itemValue="C" />
						<f:selectItem itemLabel="D" itemValue="D" />
					</p:selectOneMenu>
					<p:panelGrid id="panelDown" columns="3" style="width:400px;">
						<ui:repeat var="conn" value="#{nodeMB.placa.conectorList}">

							<p:outputLabel rendered="#{not empty conn.downstreamList}"
								value="Conector: #{conn.numConector}" />

							<p:selectManyCheckbox rendered="#{not empty conn.downstreamList}"
								value="#{nodeMB.selectedDowns}" layout="grid" columns="4">
								<f:selectItems value="#{conn.downstreamList}" var="down"
									itemValue="#{down.id}" itemLabel="dw#{down.numDownStream}">
								</f:selectItems>
							</p:selectManyCheckbox>
						</ui:repeat>

						<p:commandButton id="ajaxDown" value="Add"
							actionListener="#{nodeMB.addDowns}" process="@form"
							update="dtDireto" />
					</p:panelGrid>

					<br />

					<p:dataTable id="dtDireto" var="down"
						value="#{nodeMB.diretoList()}" style="width:600px;">

						<p:column>
							<f:facet name="header">
								<h:outputText value="CMTS" />
							</f:facet>
						#{down.conectorDown.placa.slot.cmts.nome}
					</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Placa" />
							</f:facet>
						#{down.conectorDown.placa.codPlaca}
					</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Conector" />
							</f:facet>
						#{down.conectorDown.numConector}
					</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Downstream" />
							</f:facet>
						#{down.numDownStream}
								</p:column>

						<p:column>
							<f:facet name="header">
								<h:outputText value="Direto" />
							</f:facet>
							<ui:repeat var="node" value="#{down.nodes}">
								
								#{node.codNode}, 

								</ui:repeat>
						</p:column>
					</p:dataTable>

					<br />

					<p:commandButton value="Cadastrar" id="addNode" update="growl"
						actionListener="#{nodeMB.save}"
						action="cmtsCreateEdit?faces-redirect=true" />
				</h:panelGroup>
			</p:panel>
		</h:form>
	</ui:define>
</ui:composition>